<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>$VIRUS Tracker</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      background-color: black;
      color: #0f0;
      font-family: Arial, sans-serif;
      text-align: center;
    }

    .map-container {
      position: relative;
      width: 100%;
      height: 100vh;
      overflow: hidden;
    }

    .map {
      width: 100%;
      height: 100%;
      background-image: url('http://www.pixelstalk.net/wp-content/uploads/2016/06/World-Map-Wallpaper-HD-Free-Download.jpg');
      background-size: cover;
      background-position: center;
    }

    .title {
      position: absolute;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 3rem;
      font-weight: bold;
      text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.7);
      color: red;
    }

    canvas {
      position: absolute;
      top: 0;
      left: 0;
      pointer-events: auto;
      width: 100%;
      height: 100%;
    }
  </style>
</head>
<body>
  <div class="map-container">
    <div class="map"></div>
    <div class="title">$VIRUS</div>
    <canvas id="infectionCanvas"></canvas>
  </div>

  <script>
    const canvas = document.getElementById('infectionCanvas');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    // Africa border coordinates (provided by you)
    const africaBorderCoordinates = [
      {x: 0.463, y: 0.470}, {x: 0.457, y: 0.479}, {x: 0.451, y: 0.492},
      {x: 0.441, y: 0.506}, {x: 0.429, y: 0.531}, {x: 0.433, y: 0.541},
      {x: 0.432, y: 0.555}, {x: 0.431, y: 0.561}, {x: 0.434, y: 0.577},
      {x: 0.443, y: 0.600}, {x: 0.452, y: 0.611}, {x: 0.462, y: 0.611},
      {x: 0.472, y: 0.611}, {x: 0.488, y: 0.607}, {x: 0.495, y: 0.607},
      {x: 0.501, y: 0.614}, {x: 0.504, y: 0.636}, {x: 0.515, y: 0.663},
      {x: 0.518, y: 0.693}, {x: 0.516, y: 0.708}, {x: 0.525, y: 0.747},
      {x: 0.534, y: 0.783}, {x: 0.544, y: 0.781}, {x: 0.567, y: 0.774},
      {x: 0.575, y: 0.758}, {x: 0.582, y: 0.745}, {x: 0.583, y: 0.738},
      {x: 0.585, y: 0.716}, {x: 0.600, y: 0.696}, {x: 0.595, y: 0.670},
      {x: 0.600, y: 0.646}, {x: 0.618, y: 0.623}, {x: 0.631, y: 0.578},
      {x: 0.614, y: 0.580}, {x: 0.608, y: 0.578}, {x: 0.599, y: 0.562},
      {x: 0.591, y: 0.541}, {x: 0.583, y: 0.518}, {x: 0.576, y: 0.503},
      {x: 0.581, y: 0.486}, {x: 0.561, y: 0.486}, {x: 0.546, y: 0.486},
      {x: 0.531, y: 0.492}, {x: 0.513, y: 0.472}, {x: 0.510, y: 0.463},
      {x: 0.496, y: 0.463}, {x: 0.480, y: 0.470}, {x: 0.465, y: 0.469},
      {x: 0.455, y: 0.488}, {x: 0.428, y: 0.518}, {x: 0.429, y: 0.521},
      {x: 0.431, y: 0.562}
    ];

    // Initialize infection dots array
    const infectionDots = [];

    // Function to convert relative coordinates to pixel positions on the canvas
    function convertToPixelCoords(relX, relY) {
      return {
        x: relX * canvas.width,
        y: relY * canvas.height,
      };
    }

    // Function to check if a point is inside the African border polygon
    function isInsideAfrica(x, y) {
      let insideFlag = false;
      for (let i = 0, j = africaBorderCoordinates.length - 1; i < africaBorderCoordinates.length; j = i++) {
        let xi = africaBorderCoordinates[i].x * canvas.width,
            yi = africaBorderCoordinates[i].y * canvas.height;
        let xj = africaBorderCoordinates[j].x * canvas.width,
            yj = africaBorderCoordinates[j].y * canvas.height;

        let intersect = ((yi > y) != (yj > y)) && (x < (xj - xi) * (y - yi) / (yj - yi) + xi);
        if (intersect) insideFlag = !insideFlag;
      }
      return insideFlag;
    }

    // Function to simulate the infection
    function simulateInfection() {
      const numDotsToAdd = 3;
      for (let i = 0; i < numDotsToAdd; i++) {
        let x, y, pixelCoords;

        // Pick random position inside Africa until we get a valid spot
        do {
          // Pick random position within the map
          x = Math.random();
          y = Math.random();

          // Convert to pixel coordinates
          pixelCoords = convertToPixelCoords(x, y);

          // Check if the position is inside Africa
          if (isInsideAfrica(pixelCoords.x, pixelCoords.y)) {
            break;
          }
        } while (true);

        // Create and store a new infection dot
        const newDot = new InfectionDot(pixelCoords.x, pixelCoords.y, 2);
        infectionDots.push(newDot);
      }

      // Clear the canvas and redraw the dots
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      infectionDots.forEach((dot) => {
        dot.update();
        ctx.beginPath();
        ctx.arc(dot.x, dot.y, dot.radius, 0, Math.PI * 2);
        // Set solid red color with transparent alpha applied directly
        ctx.fillStyle = `rgba(255, 50, 50, 0.5)`; // Red with 50% opacity
        ctx.fill();
      });
    }

    // Infection dot constructor
    function InfectionDot(x, y, radius) {
      this.x = x;
      this.y = y;
      this.radius = radius;
      this.growthRate = 1;
    }

    // Update function for growing dots
    InfectionDot.prototype.update = function () {
      const maxRadius = this.calculateMaxRadius();
      if (this.radius < maxRadius) {
        this.radius += this.growthRate; // Continue growing until it reaches the max allowed radius
      }
    };

    // Calculate the maximum radius that keeps the infection dot within the African borders
    InfectionDot.prototype.calculateMaxRadius = function () {
      let maxRadius = Infinity;
      for (let i = 0; i < africaBorderCoordinates.length; i++) {
        const borderCoord = africaBorderCoordinates[i];
        const distance = Math.sqrt(
          Math.pow(this.x - borderCoord.x * canvas.width, 2) +
          Math.pow(this.y - borderCoord.y * canvas.height, 2)
        );
        maxRadius = Math.min(maxRadius, distance); // Keep the smallest distance as the max radius
      }
      return maxRadius;
    };

    // Run the simulation every 100 milliseconds for a faster effect
    setInterval(simulateInfection, 100);

    window.addEventListener('resize', () => {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    });
  </script>
</body>
</html>
